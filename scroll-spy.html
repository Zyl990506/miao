<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        div {
            display: flex;
        }
    </style>
</head>

<body>
    <div>
        <aside></aside>
        <main>
            <h1>Lorem ipsum dolor sit amet consectetur adipisicing elit. Possimus, inventore?</h1>
            <p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Praesentium, omnis aspernatur nam, similique eos qui consequuntur aperiam veniam inventore quasi officiis, vero veritatis. Quasi facere vero optio enim hic ducimus!</p>
            <p>Sed voluptatem commodi reiciendis mollitia vero id natus ipsum eos. Et voluptatum aperiam in totam laborum error corrupti dolorem ab doloribus, reiciendis ipsa perspiciatis ipsam, ad minus provident porro sunt.</p>
            <p>Rerum velit tempora ullam odit exercitationem officiis harum voluptatem? Beatae voluptates, reiciendis excepturi tenetur blanditiis veritatis illum deleniti atque eligendi, iusto vel molestias dolorum nostrum at? Officiis, est ipsa. Omnis.</p>
            <p>Minima magni esse minus molestiae, totam laborum repudiandae ducimus ex culpa blanditiis magnam ipsam nam! Adipisci cupiditate culpa commodi illo explicabo delectus, porro enim facere sed! Ipsam recusandae enim aspernatur.</p>
            <p>Quos quia corporis, assumenda nisi ut dignissimos veritatis eum rerum nihil excepturi soluta vel voluptatibus facere ipsum animi temporibus dicta esse? Officiis voluptate nulla numquam quaerat, distinctio dignissimos eum inventore?</p>
            <h1>Doloribus suscipit quos nobis nesciunt inventore incidunt laudantium doloremque cupiditate.</h1>
            <p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Obcaecati eum fuga aliquam voluptas sunt adipisci maiores sit consequuntur nesciunt ullam id qui architecto cupiditate quo reprehenderit nemo explicabo, culpa ut.</p>
            <p>Voluptates eius dicta recusandae laudantium maxime sint? Ratione ad pariatur quidem laboriosam, nostrum deleniti? Architecto excepturi ad ullam tempora, facere aliquam eos provident quos? Quos perspiciatis repellat vel dolor dolorem.</p>
            <p>Reprehenderit dolorum explicabo assumenda adipisci, perferendis modi, error commodi, illum magni ea voluptas quaerat! Ratione, sunt dolor excepturi suscipit accusantium, repellat nostrum laboriosam odio natus sequi libero. Nemo, esse tempora?</p>
            <p>Quidem hic iste sit eligendi qui! Illum error delectus voluptate consequuntur. Dolor similique culpa cupiditate! Laboriosam recusandae amet at asperiores quasi officia fugit dolores alias inventore. Pariatur atque nulla nam.</p>
            <p>Dolorem ullam excepturi quidem pariatur. Molestiae enim libero suscipit magni pariatur eligendi amet deleniti quia. Qui, vitae. Ratione, reiciendis! Enim sequi aperiam maxime, accusantium omnis et voluptatem cupiditate eligendi possimus!</p>
            <h1>Quibusdam explicabo nisi rerum ad reprehenderit aspernatur velit omnis animi.</h1>
            <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Beatae voluptate ratione, facere voluptatem ea consectetur facilis excepturi enim magnam aspernatur. Beatae fugit, commodi nesciunt explicabo ea cupiditate quaerat odio assumenda?</p>
            <p>Maiores corrupti placeat ut quidem accusantium deleniti pariatur hic est, facilis eligendi consequuntur, ex repellat, magnam velit? Laborum id rem aut? Sint veniam aut delectus. Eos voluptate aperiam nam voluptatem?</p>
            <p>Sunt modi nostrum aliquam facere, rem a soluta consequuntur iusto recusandae minima, quos quam aliquid eius nam exercitationem earum odio quia ut? Deserunt excepturi quod alias id necessitatibus, natus facere.</p>
            <p>Exercitationem natus, iure sunt, delectus voluptas dolor deleniti sequi quae et debitis voluptate repellat excepturi optio magnam pariatur itaque vero doloremque provident nemo quisquam, aliquam doloribus quis modi? Esse, temporibus?</p>
            <p>Aspernatur, sed, ipsa natus ad obcaecati consequuntur tempore vel asperiores numquam delectus quisquam a. Enim illum natus, consectetur sapiente similique quas rem adipisci autem sit cum esse, repellat excepturi quae.</p>
            <h1>Deleniti necessitatibus sequi eius ab quasi odio eos officia minus.</h1>
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Repellendus vitae voluptas, beatae sit odio quo magnam vel quam aliquam temporibus blanditiis eaque excepturi mollitia doloribus voluptatem eos consequuntur esse odit?</p>
            <p>Voluptates saepe praesentium, repudiandae ex veniam neque, voluptas, maxime at aut cum recusandae aliquam placeat dolor! Doloremque eligendi, impedit, sed quis non est enim debitis ducimus delectus rerum numquam autem.</p>
            <p>Minus veritatis eligendi alias dignissimos ipsum voluptate assumenda repellendus natus, suscipit incidunt excepturi. Neque, praesentium? Corporis in culpa velit ipsum nulla omnis, saepe officia, iusto quae, unde molestiae explicabo non.</p>
            <p>Autem nostrum vero dolores earum unde, vel, velit itaque aperiam adipisci placeat quas. Quis deleniti ut, quia, nesciunt aut earum eius tempore, ad cumque magni necessitatibus dolorem sit dolorum sunt?</p>
            <p>Optio sunt minima sequi autem, beatae rem odit repudiandae? Laborum vitae similique eos repudiandae in omnis cum! Accusantium assumenda vero rem incidunt eaque earum laudantium quas omnis dicta. Non, aliquam.</p>
            <h1>Esse aliquam, quo reiciendis aut adipisci non laudantium commodi harum.</h1>
            <p>Lorem ipsum, dolor sit amet consectetur adipisicing elit. Id placeat labore et fuga natus, voluptates, non, atque sit enim error possimus. Amet, numquam praesentium delectus ut recusandae deleniti dolor dolorem.</p>
            <p>Ut suscipit repudiandae voluptatem aperiam, assumenda non minima, cum, harum porro excepturi totam aut laborum quia quae natus dolorum a! Alias fuga asperiores in distinctio quam quia. Eos, autem soluta.</p>
            <p>Numquam at itaque ex laudantium in placeat animi eveniet dolorem omnis perspiciatis suscipit excepturi, quo cumque fugit doloribus ipsam deserunt non voluptates sequi magnam incidunt? Quis vitae quisquam assumenda suscipit.</p>
            <p>Minima quam, possimus ipsam eos pariatur dolore cum commodi, similique aspernatur quos sapiente quidem voluptate vel eum. Sapiente rem velit dolores voluptatum quasi odio, adipisci doloribus, suscipit corporis molestias eveniet?</p>
            <p>Odit animi repellat neque provident eaque magni ab nam odio dolorum maiores repellendus nisi dolorem eos tempora, quaerat rem, totam quos quasi quis quisquam ipsum! Vero accusantium ipsam ratione magnam!</p>
            <h1>Deleniti eveniet maiores est delectus cupiditate autem sint obcaecati perspiciatis.</h1>
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Nulla ullam, quo, laborum corrupti sunt ducimus aliquam dolor odio dolorem excepturi, fugit ex labore! Facere dolor animi, sit eveniet maxime enim.</p>
            <p>Natus consectetur fugit sapiente reiciendis a sequi voluptatem, est non nihil dolores obcaecati rerum porro quidem. Itaque voluptas tempore eius, velit, quasi officia autem quam, unde perferendis eos quis eum.</p>
            <p>Cumque, doloremque consequuntur! Ullam dolore blanditiis eos, at cupiditate nobis necessitatibus sunt, corrupti optio maiores, id aperiam. Fugit odit eaque nobis esse, alias nihil dolor impedit delectus fuga quod possimus.</p>
            <p>Laudantium, odit excepturi eveniet porro officiis aperiam dolor consequatur odio neque enim. Voluptatem possimus recusandae illo eius adipisci, molestiae esse, beatae magnam laboriosam amet repudiandae veniam consectetur! Reprehenderit, veritatis
                fugiat.
            </p>
            <p>Cupiditate, incidunt error. Natus harum corporis vel saepe fuga, ducimus facilis? Eius rerum dignissimos atque culpa, deserunt veritatis iure obcaecati nulla, ratione perferendis iusto quos magni dolorum corporis beatae incidunt.</p>
            <h1>Atque inventore ad aspernatur eligendi? Facilis accusantium nostrum quo fugiat.</h1>
            <p>Lorem ipsum, dolor sit amet consectetur adipisicing elit. Odit totam, ad autem voluptatibus natus magnam veniam libero exercitationem ullam rem doloribus cum, ab quasi voluptate corrupti atque minus illo impedit.</p>
            <p>Laboriosam nulla sed animi eaque amet dolore autem iure, consequuntur quam temporibus ratione voluptas earum perferendis odit unde! Quam rerum tempore modi quidem consequuntur hic aperiam dolorem. Laudantium, dicta nesciunt.</p>
            <p>Illo facilis debitis dolore. Unde similique ipsum inventore repudiandae, libero qui excepturi non, animi quam optio molestias obcaecati ipsa quibusdam tempora ab recusandae? Ipsum recusandae blanditiis officiis animi perspiciatis reprehenderit.</p>
            <p>Quo itaque exercitationem, culpa ipsam sapiente est illum vel nesciunt cupiditate repudiandae voluptas excepturi cum perferendis velit eaque atque nulla et non odit. Reprehenderit libero, mollitia dignissimos aperiam illo minima?</p>
            <p>Praesentium voluptate odit laboriosam quidem saepe. Sit modi at sunt vitae beatae officiis omnis eum nihil quidem, quae ea consectetur. Enim exercitationem quasi maiores minus reprehenderit nulla porro cumque voluptatum?</p>
            <h1>Illo eius repellendus iure in impedit blanditiis maxime reiciendis quo!</h1>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Laborum eius sequi quia pariatur. Non praesentium quo, officia, provident ut error mollitia reiciendis dolore voluptate, dignissimos tempore distinctio molestias aperiam excepturi!</p>
            <p>Magni at, repudiandae totam voluptatem, exercitationem pariatur in sed, voluptate accusamus unde recusandae tempora modi possimus aliquam quas quae. Id sunt officia, eaque hic blanditiis natus dolores debitis dignissimos labore!</p>
            <p>Laboriosam dolore harum sapiente qui non corrupti, perferendis, fugit quod quia, ratione sequi rerum veritatis nihil autem. Explicabo, neque dolor, quos sed assumenda exercitationem perferendis dolorem iste, tempore dicta voluptatibus?</p>
            <p>Rem, saepe tempora maiores officiis tempore id esse dolores consequatur! Aperiam, omnis magni dolorum optio voluptates dolores minus deserunt eius, quas ea corrupti illum necessitatibus aliquam illo odio ipsam ipsum!</p>
            <p>Eum, modi consectetur. Velit placeat adipisci rem officia aliquam libero. Labore aspernatur quas maxime porro sapiente tempora iure nemo dignissimos, sit, eveniet hic molestias consequatur quod ratione cum, nihil iste.</p>
            <h1>Velit esse consequuntur eos voluptatibus vero minus quae? Corrupti, atque!</h1>
            <p>Lorem ipsum dolor sit, amet consectetur adipisicing elit. Ut voluptate facere enim odit dolor, quia delectus nihil expedita totam, cum deserunt sint itaque voluptates porro eius voluptatibus dicta distinctio fugiat?</p>
            <p>Assumenda facilis cumque delectus iure voluptatem deleniti aliquid tenetur? Aliquid possimus dolor eligendi totam repudiandae numquam sequi corporis impedit vero, adipisci explicabo mollitia accusantium beatae repellat repellendus! Autem,
                voluptatem reiciendis!</p>
            <p>Corporis ipsa minus sed quisquam non vel consequuntur nemo eaque unde! Culpa cum vero nisi corrupti commodi voluptatum voluptas atque laudantium, ea inventore ullam voluptatibus veniam quae odit harum blanditiis.</p>
            <p>Excepturi odio veniam numquam et. Soluta sunt excepturi pariatur labore doloremque? Necessitatibus sint quo quasi beatae, corporis nam, molestiae dignissimos ipsam rerum laboriosam quaerat nobis iusto odio ut. Beatae, nesciunt.</p>
            <p>At laboriosam aut perspiciatis beatae dolor. Corporis, atque. Deleniti, rem? Neque deleniti iure optio necessitatibus unde, quis vitae veritatis quam soluta velit asperiores non! Libero corrupti explicabo nobis fugiat. Sequi.</p>
            <h1>Accusamus voluptatem sunt iste maiores, voluptatibus at a culpa saepe.</h1>
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Iure praesentium in fuga delectus ratione exercitationem, ipsam possimus tenetur quae, aspernatur officia, iste vero sunt quasi. In nobis recusandae autem! Itaque.</p>
            <p>Facere aperiam porro quasi commodi placeat, assumenda corrupti sed eveniet aspernatur, ex maxime distinctio officia odio laboriosam unde fugit repellat est error. Voluptatum facere ullam voluptas consectetur voluptatibus porro autem.</p>
            <p>Eius, fugiat eum magnam porro nam sint deserunt numquam distinctio accusamus voluptate dolores fugit consequuntur inventore! Facilis illo saepe eius! Vitae, aperiam. Optio suscipit mollitia aliquam pariatur dolorum quaerat eum.</p>
            <p>Magnam sequi a praesentium doloribus harum earum omnis placeat similique nemo est perferendis consequatur, explicabo possimus sed id? Natus iusto porro voluptas itaque quia fuga accusantium delectus odio modi incidunt.</p>
            <p>Deleniti fuga laborum exercitationem rem animi accusamus quas, architecto itaque eaque, commodi voluptate suscipit doloribus voluptatibus ex consectetur nam quam temporibus unde tempore, nihil totam magnam a ad. Beatae, ab.</p>
        </main>
    </div>
    <script>
        function scrollSpy(contentNode, tocNode) {
            var headers = Array.from(contentNode.querySelectorAll('h1,h2,h3'))
            var idPrefix = 'id_' + Math.random().toString(16).slice(2) //生成随机id
            var idCount = 0
            for (var header of headers) {
                if (!header.id) {
                    header.id = idPrefix + (idCount++) // 如果没有id 则加上id
                }
                var anchor = document.createElement('a') // 创建a标签
                anchor.textContent = header.textContent.substr(0, 20) //在header中从0开始取20长度字符串加入anchor中
                anchor.href = '#' + header.id
                anchor.className = 'toc-item'
                tocNode.append(anchor)
            }
            // 当元素的高度与可滚动内容的高度相同时，说明不能滚动
            // if (contentNode.scrollHeight == contrntNode.offsetHeight) {

            // }
            window.addEventListener('scroll', function(e) {
                var boxes = headers.map(it => it.getBoundingClientRect()) //返回元素的大小及其相对于视口的位置
                var curIdx = boxes.findIndex(it => it.y >= 0) // 找到当前正显示的部分的标题的下标
                if (boxes[curIdx].y > window.innerHeight) {
                    curIdx--
                }
                var curHeader = headers[curIdx]
                var curId = curHeader.id
                var selector = `.toc-item[href="#${curId}"]` //创造一个找出类名为toc-item并且herf为#${curId}的选择器
                var curAnchor = tocNode.querySelector(selector)
                Array.from(tocNode.children).forEach(it => {
                    it.classList.remove('active') //把所有a标签的active去掉
                })
                curAnchor.classList.add('active') //把找到的a标签增加一个active类名进行高亮
            })
        }
        var main = document.querySelector('main')
        var aside = document.querySelector('aside')
        scrollSpy(main, aside)
    </script>
    <style>
        aside {
            width: 300px;
            position: fixed;
            top: 0;
            left: 0;
        }
        
        main {
            margin-left: 300px;
        }
        
        .toc-item {
            display: block;
        }
        
        .toc-item.active {
            color: red;
        }
    </style>
</body>

</html>